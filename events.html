<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>dates</title>
<script type="text/javascript" src="js/lib/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="js/lib/d3.v3.js"></script>
		<style type="text/css">

			body {
				/*background-color: #ccc;*/
			}

			svg {
				background-color: white;
			}
			#container{
				margin-left:10px;
				margin-right:10px;
				width:100%;
			}
			
			.axis path,
			.axis line {
				fill: none;
				stroke: black;
				shape-rendering: crispEdges;
			}
			
			.axis text {
				font-family: sans-serif;
				font-size: 11px;
			}

		</style>
	</head>
	<body>
		<div id= "container"></div>
		<script type="text/javascript">
			var padding = 40;

			//Width and height
			var w = $("#container").innerWidth()-20;
			var h = window.innerHeight-10;

			var data;
			d3.csv("dates2.csv", function(d){
				data = d;
				console.log(data);
				processData();
			})
			var dateMin, dateMax;
			// 1 = "11/12/2015"
			// var dateParser1 = d3.time.format("%m/%d/%Y");
			// dateParser1.parse(data.date);
			
			//2 = // "Wednesday, November 12, 2014"
			// var dateParser2 = d3.time.format("%A, %B %-d, %Y")
			var dateParser = d3.time.format("%d/%m/%Y");
		    function onlyUnique(value, index, self) { 
		        return self.indexOf(value) === index;
		    } 
		    function peopleConsolidation(givenAuthor,i) { 
		        var total = 0;
		        for (i = 0;i<theseAuthors.length; i++){ 
		            if(theseAuthors[i] == givenAuthor){
		                total++;
		            }else{
		            }
		        }
		         return total;
		     } 
			var normDates = [];
			var people = [];

			function processData(){
				for(i=0; i<data.length; i++){
					normDates.push(new Date(dateParser.parse(data[i].date)));							
				
					people.push(data[i].attendees)
				}
				createScales();
			}

			var xScale = d3.scale.linear()					
				.range([padding, w - padding]);
		    
		    var colorSpectrum = [
			    "#fc5988" 
			    ,"#b14a41"
			    ,"#6ab054"
			    ,"#8675ee"
			    ,"#fcb752"
			    ,"#89e2fe"]

			var uniquePeople;
		    var colorPeople = d3.scale.ordinal()
		        .range(colorSpectrum);
			function createScales(){
				dateMin = d3.min(normDates);
				dateMax = d3.max(normDates);
				uniquePeople = people.filter(onlyUnique)
				
				colorPeople
			        .domain(uniquePeople)
			//Create scale functions
				xScale
					.domain([dateMin, dateMax])

			// var yScale = d3.scale.linear()
			// 					 .domain([0, d3.max(dataset, function(d) { return d[1]; })])
			// 					 .range([h - padding, padding]);

			//Define X axis
			// var xAxis = d3.svg.axis()
			// 				  .scale(xScale)
			// 				  .orient("bottom")
			// 				  .ticks(5);

			//Define Y axis
			// var yAxis = d3.svg.axis()
			// 				  .scale(yScale)
			// 				  .orient("left")
			// 				  .ticks(5);
				createSVG();
			}
			var svg;
			function createSVG(){
				//Create SVG element
				svg = d3.select("#container")
							.append("svg")
							.attr("width", w)
							.attr("height", h);
				visData();	
			}


			function visData(){
				console.log(data.length);
				//Create circles
				svg.append("g")
				   .attr("id", "circles")
				   .selectAll("circle")
				   .data(data)
				   .enter()
				   .append("circle")
				   .attr("cx", function(d,i) {
				   		return xScale(new Date(dateParser.parse(d.date)));
				   		// return 10+i*15;
				   	})
				   .attr("cy", h/2)
				   .attr("fill",function(d,i){
				   		// console.log(d.attendee)
					   	return colorPeople(d.attendees)
				   })
				   .attr("r",5)
			}


		</script>
	</body>
</html>